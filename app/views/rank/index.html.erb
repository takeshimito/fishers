<%= javascript_include_tag 'jquery.raty' %>

<div class="index">
  <div class="headder">
    <p>ランキング</p>
    <p>お気に入り（ハート）の数を参考に多い順に並べております。</p>
  </div>
  <% @posts.each do |post| %>
    <div class="row justify-content-center mt-1">
      <div class="col-sm-10">
        <div class="card col-sm">
          <div class="row no-gutters">
            <div class="col-md-6 img-box">
              <%= image_tag post.image.url, class: "post-img" if post.image? %>
            </div>
            <div class="col-md-6">
              <div class="card-body">
                <p class="card-title">投稿者：<%= link_to post.user.name, user_path(post.user), :style=>"color:black;" %></p>
                <p class="card-title">タイトル：<%= link_to post.title, post_path(post), :style=>"color:black;" %></p>
                <p class="card-text" id="star-rate-<%= post.id %>">おすすめ度：</p>
                  <script>
                    $('#star-rate-<%= post.id %>').raty({
                    starOff:  '<%= asset_path('star-off.png') %>',
                    starOn : '<%= asset_path('star-on.png') %>',
                    starHalf: '<%= asset_path('star-half.png') %>',
                    half: true,
                    readOnly: true,
                    score: <%= post.rate %>,
                    });
                  </script>
                <p class="card-text">
                  <%=safe_join(post.content.split("\n"),tag(:br))%>
                </p>
                <p class="card-text">
                  <small class="text-muted">
                    緯度：<%= post.latitude %>
                    経度：<%= post.longitude %>
                    <%= post.prefecture.name %>
                  </small>
                </p>
                <small>お気に入り：<span class="badge badge-secondary"><%= post.favorite_users.count %></span></small>
                <%= render 'favorites/favorite_button',  post: post %>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  <% end %>
</div>